syntax = "proto3";

enum MessageType {
    Bootstrap_query = 0;
    Bootstrap_reply = 1;

    Find_node_query = 2;
    Find_node_reply = 3;

    Find_value_query = 4;
    Find_value_reply = 5;

    Store_query = 6;
    Store_reply = 7;

    Ping_query = 8;
    Ping_reply = 9;
}

message NodeIdProto {
    fixed64 high = 1;
    fixed64 low = 2;
}

message PeerInfoProto {
    NodeIdProto key = 1;
    bytes addr = 2;    // must be 4 bytes
    uint32 port = 3;
}

message Message {
    MessageType type = 1;
    PeerInfoProto from_user = 2;
    PeerInfoProto to_user = 3;
    NodeIdProto find_user = 4;
    int64 timestamp = 5;
    uint64 nonce = 6;

    repeated PeerInfoProto result = 7;
    bool bootstrapped = 8;
}